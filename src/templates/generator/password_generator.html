<div hx-swap="none">
    <div class="columns is-multiline is-centered">
        
        <div class="column is-12-tablet is-10-desktop">
            <div id="gamification-panel" class="box">
                <div class="level is-mobile mb-3">
                    <div class="level-left">
                        <div class="level-item">
                            <h3 class="title is-5 theme-title mb-0">
                                <span class="icon mr-1"><i class="fas fa-trophy has-text-warning"></i></span>
                                Статистика нашего сервиса
                            </h3>
                        </div>
                    </div>
                    <div class="level-right">
                        <div class="level-item is-flex is-align-items-center"> <span class="is-size-6 mr-3 has-text-weight-medium is-hidden-mobile" style="line-height: 1;">
                                Всего сгенерировано паролей:
                            </span>
                            <span class="tag is-primary is-medium is-rounded has-text-weight-bold" id="global-counter" style="height: 2em;">
                                {{ total_passwords|default:"0" }}
                            </span>
                        </div>
                    </div>
                </div>

                <hr class="theme-divider" style="background-color: rgba(0,0,0,0.1); margin: 0.5rem 0 1rem 0;">

                <div id="random-tip-container">
                    <div class="icon-text mb-2">
                        <span class="icon has-text-info"><i class="far fa-lightbulb"></i></span>
                        <span class="has-text-weight-bold is-size-6">Полезный совет</span>
                    </div>
                    
                    {% if random_tip %}
                        <div class="notification is-white p-3 is-size-6" style="border-left: 4px solid #3298dc;">
                            <p class="mb-2 has-text-dark"><strong>{{ random_tip.title }}</strong></p>
                            <p class="is-size-7 mb-2 has-text-grey-dark">
                                {{ random_tip.content|striptags|truncatewords:25 }}
                            </p>
                            <a href="{% url 'tip_detail' random_tip.pk %}" target="_blank" class="button is-small is-ghost pl-0">
                                Читать подробнее →
                            </a>
                        </div>
                    {% else %}
                        <p class="is-size-7 has-text-grey">Загрузка советов...</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="column is-12-tablet is-10-desktop">
            <div class="box">
                <h2 class="title is-2 mb-5 theme-title">Генератор паролей</h2>
                <hr class="theme-divider" style="background-color: rgba(0,0,0,0.1); margin: 0.5rem 0 1rem 0;">
                                {% csrf_token %}
                <div class="field">
                    <label class="label theme-text" for="password">Ваш пароль:</label>
                    <div id="password-container">
                        <input id="password" class="input is-medium has-text-centered has-text-weight-bold" type="text" value="{{ password }}" readonly />
                    </div>
                </div>

                <div class="buttons mt-5">
                    <button 
                        class="button is-primary is-medium" 
                        hx-post="/generate-password/" 
                        hx-trigger="click" 
                        hx-target="#password-container"
                        hx-swap="innerHTML"
                        hx-include="[name='csrfmiddlewaretoken'], [name='length'], [name='include_digits'], [name='include_special_chars'], [name='include_hyphen'], [name='include_underscore']">
                        <span class="icon"><i class="fa-solid is-white fa-unlock-keyhole"></i></span>
                        <span class="is-white">Сгенерировать</span>
                    </button>
                    
                    <button class="button is-primary is-outlined is-medium copy-button" data-target="password">
                        <span class="icon"><i class="fa-solid fa-copy"></i></span>
                        <span>Копировать</span>
                    </button>
                </div>
                <hr class="theme-divider" style="background-color: rgba(0,0,0,0.1); margin: 0.5rem 0 1rem 0;">
                <div class="field">
                    <label class="label theme-text" for="length">Длина пароля:</label>
                    <div class="control">
                        <div class="columns is-mobile is-vcentered">
                            <div class="column is-3">
                                <input 
                                    type="number" 
                                    name="length" 
                                    id="id_length" 
                                    class="input has-text-centered has-text-weight-bold" 
                                    value="{{ form.length.value|default:12 }}" 
                                    min="8" 
                                    max="64"
                                >
                            </div>
                            <div class="column is-9">
                                <input 
                                    type="range" 
                                    id="length_range" 
                                    class="slider is-fullwidth is-circle" 
                                    min="8" 
                                    max="64" 
                                    value="{{ form.length.value|default:12 }}"
                                    style="accent-color: var(--primary-color); width: 100%; cursor: pointer;"
                                >
                            </div>
                        </div>
                    </div>
                </div>
                <div class="columns is-multiline mb-5">
                    
                    <div class="column is-6-mobile is-6-tablet">
                        <label class="option-card-label">
                            {{ form.include_digits }}
                            <span class="icon is-small has-text-info mr-2">
                                <i class="fa-solid fa-arrow-down-1-9"></i>
                            </span>
                            <span class="has-text-weight-medium theme-text">Цифры (0-9)</span>
                        </label>
                    </div>

                    <div class="column is-6-mobile is-6-tablet">
                        <label class="option-card-label">
                            {{ form.include_special_chars }}
                            <span class="icon is-small has-text-warning mr-2">
                                <i class="fa-solid fa-asterisk"></i>
                            </span>
                            <span class="has-text-weight-medium theme-text">Символы (@#$)</span>
                        </label>
                    </div>

                    <div class="column is-6-mobile is-6-tablet">
                        <label class="option-card-label">
                            {{ form.include_hyphen }}
                            <span class="icon is-small has-text-success mr-2">
                                <i class="fa-solid fa-minus"></i>
                            </span>
                            <span class="has-text-weight-medium theme-text">Дефис (-)</span>
                        </label>
                    </div>

                    <div class="column is-6-mobile is-6-tablet">
                        <label class="option-card-label">
                            {{ form.include_underscore }}
                            <span class="icon is-small has-text-danger mr-2">
                                <i class="fa-solid fa-underline"></i>
                            </span>
                            <span class="has-text-weight-medium theme-text">Подчерк. (_)</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
        <div class="column is-12-tablet is-10-desktop">
            <div id="instruction-column" class="box">
                <h2 class="title is-4 has-text-grey">Как это работает?</h2>
                <div class="content is-size-6">
                    <p>Этот сервис позволяет вам генерировать безопасные пароли:</p>
                    <ol>
                        <li>Укажите желаемую длину (рекомендуем от 12 символов).</li>
                        <li>Выберите сложность (цифры, символы).</li>
                        <li>Нажмите <strong>"Сгенерировать"</strong>.</li>
                        <li>Скопируйте результат и сохраните в надежном месте.</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
</div>